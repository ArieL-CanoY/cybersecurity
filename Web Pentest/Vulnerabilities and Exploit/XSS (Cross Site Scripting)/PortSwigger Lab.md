Note: The proof of concept code alert() is depend on the behavior of the website, code used for other type of XSS can also used to another type.

---------------------------------------------- Labs on Portswigger ---------------------------------------------------------

  

----------------------  Reflected XSS ----------------------

  

```bash
Reflected XSS into HTML context with nothing to encoded

- having no defense for xss attack can insert this "<script>alert()</script>" script will easily trigger xss

```

  
```bash
Reflected XSS on attribute with angle brackets HTML-encoded

     - inserting angle brackets like this "< and >" will be encoded to HTML to "&gt; and &lt;", therefore we cannot escape it so we focus on the attribute and inserting the onfocus="malicious_code" will execute it. onfocus attribute is usually used on the textarea and inputs and execute when the mouse cursor is on the area of input

```

  
```bash
Reflected XSS into a JavaScript string with angle brackets HTML-encoded

     - query string will reflect on single with double quote like this " ' string_query ' " with angle brackets HTML-encoded so this is impossible to escape and also the the h1 tag, but the string also appear on the script and no defense implemented so we can break it by ending the javascript by this '; and inserting the malicious code alert(); and inserting the last code to not break the script by this '
```

reflect on the page and on the script if we put abc123 as query string to search:
![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(6).png)

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(7).png)

script:

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(8).png)

  

solution:

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(9).png)

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(10).png)

  

  

  

---------------------- Stored XSS ----------------------

```bash
Stored XSS into HTML context with nothing encoded

     - stored xss is more dangerous when it comes to blog post because many people can visit the page more often and therefore many people will trigger the malicious code that will lead all people visit that page become vulnerable.

```
  

```bash
Stored XSS in anchor href attribute with double quotes HTML-encoded

     - inserting the website link on the comments will make the author's name a clickable link so we can insert javascript:malicious_code and it will execute it when it click

```
  

website input:

`empty will fill this up in the future`

link will embed on the author's name:

![](en-resource://resourcemap/9d712de6c08f643cc1e235dfb973820c)

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(11).png)

  

  

  

---------------------- Document Object Model (DOM) XSS ----------------------
```bash
     - unsecured document object javascript code like document.write, innerHTML, window.location, etc. can use to insert malicious code/script

```
  

```bash
DOM XSS in document.write sink using source location.search

     -  query string on the input will go to the img tag/element, therefore we can escape the quote and insert malicious onload script to trigger alert for proof-of-concept (POC).
```

script:

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(12).png)


img:

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(13).png)

  


```bash
DOM XSS in innerHTML sink using source location.search

     - innerHTML is used to create new content, query string will put in the middle of and span and no defense for this attack so we can insert malicious script on image tag 
```

script:

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(14).png)

  

id with searchMessage content:

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(15).png)

  

```bash
DOM XSS in jQuery anchor href attribute sink using location.search source

     - clicking the submit feedback will appear the input url to the back button, I can change the url path to javascript:alert(document.cookie) which is needed to solve the lab and this script is useful for href or url to execute javascript code
```
  

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(16).png)

  

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(17).png)

  
DOM XSS in jQuery selector sink using a hashchange event

  

script:

![](en-resource://resourcemap/0fd719c778e4dc9be65eefbeaaa53f46)

  

script on exploit server on the lab:

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(18).png)

  

  

```bash
DOM XSS in document.write sink using source location.search inside a select element

     - in line 2, the said that search for URL if it has a parameters of storeID, and in statement, if it has, store it in the middle of option tag, therefore I can escape the option and select element and insert the malicious code like this "&storeId=</option></select><img src=x onerror="alert()">" and the alert will trigger.
```

script:

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(19).png)


payload on URL:

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(20).png)

  

  

  

----------------------------------------------------------------- Old notes ----------------------------------------------------------------------------

  
```bash
Stored XSS

     - text that can display

     <script>alert("1")</script>

          - useful in comments and other displayable text
```


  

  href:

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(21).png)

```bash
- insert malicious script when inputting a url on href, similar to breaking the attributes

- similar inserting malicious script with the input in element tag
```

  

      

  

-------------------------------------------------------------------------------------------------------------------

```bash
DOM XSS (Document Object Model)

	- unsecured document object javascript code like document.write, innerHTML, window.location, etc.



javascript:alert(1)

	- use when setting a link for href
	
	- use this as link in href



Element tag with attribute of event handler to insert malicious code/script

	- when using innerHTML = inputValue
```
