## Vertical Privilege Escalation
#### Unprotected Functionality
```bash
Unprotected admin functionality

     - Look for robots.txt to see if there is disclosed information, robots.txt is a file in which what to index or search incase some search engines used this as reference to user's searches

  

Unprotected admin functionality with unpredictable URL

     - Look for script for url, some information disclosed on the script or other code or part of the website the url of the admin page

  

```


#### Parameter based access control methods
```bash  
User role controlled by request parameter    

     - if the cookie/parameter can change to true or false or even to different names

  

User role can be modified in user profile

     - updating user profile can return and disclose a json file of your information that can be used to modify normal user's privilege and gain access to authorized personnel-only system
```

#### Broken access control resulting from platform misconfiguration
```
URL-based access control can be circumvented

     - visiting url that is access denied can access by using X-Originated-URL for some websites like  many web frameworks such as Symfony 2.7.0 to 2.7.48, 2.8.0 to 2.8.43, 3.3.0 to 3.3.17, 3.4.0 to 3.4.13, 4.0.0 to 4.0.13 and 4.1.0 to 4.1.2 , zend-diactoros up to 1.8.4, zend-http up to 2.8.1, zend-feed up to 2.10.3 are affected by this security issue.

     - example of url to bypass, this examples is denying the user to access /admin page so accessing it using x origianl url

          GET / HTTP/1.1

          X-Original-URL: /admin 

  

          GET /?username=carlos HTTP/1.1

          X-Original-URL: /admin/delete

  

Method-based access control can be circumvented

     - getting/posting/putting/deleting 401 http response or unauthorized page can bypass by changing the HTTP method, in the laboratory, using POST /admin-roles with parameter of username and action can bypass by unauthorized users by changing the http method to PUT while sending the correct url page and parameters of the page. Therefore the answer for the lab is

        POST /admin-roles

        ...

        username=wiener&action=upgrade

  

  

```


## Horizontal Privilege Escalation
```bash
User ID controlled by request parameter

     - changing the id of a current user can change to different user that will result to horizontal privilege escalation and exploit it to change/get the other user's identity/profile/account

  

User ID controlled by request parameter with unpredictable user ID

     - if the url wants a userid or email parameter, you can get it from other users by vising their profile or the link on their name.

  

User ID controlled by request parameter with data leakage in redirect

     - if changing the parameter of something and it redirects and just like nothing happen, try it to repeater for the response before it redirect

  

  

```



## Horizontal to Vertical Privilege Escalation
```

  

User ID controlled by request parameter with password disclosure

     - using id/roleid/username to change the account profile will lead to IDOR (Insecure Direct Object Reference) and with sensitive information disclosure is a critical vulnerability you want to fix.

  

Insecure direct object reference

     - downloading something that can change the parameter that is being request to download can disclose sensitive information 

  

```

#### Access control vulnerabilities in multi-step processes
```

  

Multi-step process with no access control on one step

     - example that there are 2 steps, the first step send a parameter of name to delete, the 2nd step will confirm the request which will send the name to delete and confirm parameter. If it has no access control, the attack will immediately send the 2nd HTTP request parameter to bypass the 1st step.

  

 
```



#### Referer-based access control
```


     - some applications make their access control based on the referer(tinutukoy na website), so in the laboratory, even though you are normal user, you can do administrative request like this:

  

     GET /admin-roles?username=carlos&action=upgrade

     ...

     Referer: [https://0abc00180477ae38c0862a5600be00b4.web-security-academy.net/admin](https://0abc00180477ae38c0862a5600be00b4.web-security-academy.net/admin)   

  

  

Location-based access control

     - VPNs and Proxies are typically used for this to access blocked websites
```